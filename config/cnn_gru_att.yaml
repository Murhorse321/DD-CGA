# config/cnn_gru_att.yaml
seed: 42
device: cuda

data:
  # 你的 dataset_loader 读取的键（必须有）：
  train_path: CleanData/data/step6_normalized/train.csv
  val_path: CleanData/data/step6_normalized/val.csv
  test_path: CleanData/data/step6_normalized/test.csv
  label_col: label_int
  ignore_cols: [ label ]
  input_shape: [8, 8]      # => H,W


  # feature_cols: [feat1, feat2, ..., feat64]  # 若需要显式指定列名时再打开

model:
  num_classes: 1           # 单通道输出 + BCEWithLogitsLoss
  cnn_channels: [32, 64]
  use_cbam: true
  cbam_reduction: 8
  gru_hidden: 128
  gru_layers: 1
  bidirectional: false
  attn_type: add           # add | dot
  temperature: 1.0
  dropout: 0.5
  use_batchnorm: true
  sequence_order: row

training:
  run_root: results/tuning_gru_attn
  batch_size: 256
  epochs: 100
  learning_rate: 1e-3
  weight_decay: 0.0
  pos_weight: 1.0
  amp: true
  early_stopping_patience: 10
  scheduler: cosine
  log_dir: results/cnn_gru_attn/logs
  ckpt_dir: results/cnn_gru_attn/checkpoints

inference:
  threshold: 0.50
